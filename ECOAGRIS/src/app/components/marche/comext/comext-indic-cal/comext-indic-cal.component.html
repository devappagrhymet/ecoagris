<app-header />
<!--------->

<div class="breadcrumb-card mb-25 d-md-flex align-items-center justify-content-space-between">
    <h5 class="mb-0"></h5>
    <ol class="breadcrumb mb-0 ps-0">
        <li class="breadcrumb-item fw-semibold">Marché</li>
        <li class="breadcrumb-item fw-semibold">Commerce extérieur</li>
        <li class="breadcrumb-item fw-semibold">Calcule des indicateurs</li>
    </ol>
</div>

<mat-card class="mb-25 tagus-card">
    <mat-card-header>
        <h5 class="mb-0">Commerce extérieur - calcule des indicateurs</h5>
    </mat-card-header>
    <mat-card-content>
        <!-------------------------------------------------------->
            <div style="border-left:15px solid #bd0505d7" class="row">
                <div class="col-lg-6 col-md-6">
                    <mat-card class="mb-25 tagus-card">
                        <mat-card-header class="border-bottom">
                            <h6 class="mb-0">Selectionnez</h6>
                        </mat-card-header>
                        <mat-card-content>
                            <form [formGroup]="generateurForm">
                                <div class="row">
                                    <!----------------------Pays-------------------------------------------->
                                    <!-- <div class="col-lg-6 col-md-12">
                                        <mat-form-field appearance="fill" class="example-full-width">
                                            <mat-label>Pays</mat-label>
                                            <mat-select  formControlName="pays" [(ngModel)]="params_pays">
                                                <mat-option>Selection</mat-option>
                                                <mat-option *ngFor="let country of pays" [value]="country['id']">
                                                    <img src="http://154.127.90.218:8000/{{country['image']}}" width="30px" height="15px"> {{country['nomDivision']}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div> -->
                                    <!----------------------Campagne-------------------------------------------->
                                    <div class="col-lg-6 col-md-12">
                                        <form [formGroup]="generateurForm">
                                            <mat-form-field appearance="fill" class="example-full-width">
                                                <mat-label>Année</mat-label>
                                                <mat-select  formControlName="campagne" (selectionChange)="onChangeCampagne($event)"   style="width:350px">
                                                    <mat-option *ngFor="let campagne of campagnes" [value]="campagne['annee_debut']">{{campagne['annee_debut']}}</mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </form>
                                    </div>
                                </div>
                            </form>
                        </mat-card-content>
                    </mat-card>
                </div>
                <!--========================================-->
                <div class="col-lg-6 col-md-6">
                    <mat-card class="mb-50 tagus-card">
                        <mat-card-header class="border-bottom">
                            <!-- <h6 class="mb-0">Selection un indicateur</h6> -->
                        </mat-card-header>
                        <mat-card-content>
                            <form   [formGroup]="generateurForm">
                                <mat-form-field appearance="fill"   class="example-full-width"  style="width:380px">
                                    <mat-label>Indicateur</mat-label>
                                    <mat-select    formControlName="indic" [(ngModel)]="params_indicateur"  >
                                      <!-- <mat-option *ngFor="let indicateur of indicateurs" [value]="indicateur['code']">{{indicateur['code']}} - {{indicateur['libelle']}}</mat-option> -->
                                      <mat-option>Selection</mat-option>
                                      <mat-option  [value]="88">06R005 - Valeur totale des importations de produits alimentaires</mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="84">06S002 - La valeur des exportations des produits alimentaires vers les autres pays </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="97">06S004 - La valeur des exportations de produits alimentaires (en USD) </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="90">06R008 - Part de chaque pays sur le total des importations de produits alimentaires de la sous-région </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="91">06R010 - Part intra régionale des importations de produits alimentaires en pourcentage </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="99">06S009 - Volume des exportations de produits alimentaires entre les pays de la sous-région </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="96">06S003 - Part de chaque pays dans le volume total des exportations de produits alimentaires </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="89">06R007 - Dépendance alimentaire du pays par rapport aux autres pays de la sous-région </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="77">06R004 - Taux de croissance annuel de la valeur des importations de produits alimentaires entre les pays de la sous-région </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="93">06R013 - Taux de croissance annuel, par pays, de la valeur des importations de produits alimentaires venant des autres pays de la sous-région </mat-option>
                                      <mat-option>______</mat-option>
                                      <mat-option  [value]="92">06R012 - Taux de croissance annuel du total des exportations de produits alimentaires </mat-option>
                                     
                                  <!--   <mat-option  [value]="87">06R004 - Taux de croissance annuel de la valeur des importations de produits alimentaires entre les pays de la sous-région</mat-option>
                                    <mat-option  [value]="89">06R007 - Dépendance alimentaire du pays par rapport aux autres pays de la sous-région </mat-option>
                                -->    
                                </mat-select>
                                </mat-form-field> 
                                &nbsp;&nbsp;&nbsp;
                        
                                <button mat-button (click)="generateurIndicateur()"  style="background-color:green; color:white">
                                   
                                    <!------->
                                    <i *ngIf="isLoading$ | async" class="fas fa-spinner fa-spin"></i>
                                    <span *ngIf="isLoading$ | async">Generation...</span>
                                    <!------->
                                    <i *ngIf="!(isLoading$ | async)" class="flaticon-diskette"></i>&nbsp;
                                    <span *ngIf="!(isLoading$ | async)">Valider</span>
                                    <!------->
                                </button> 
                            </form>
                        </mat-card-content>
                        <mat-card-footer>
                            <!--===========================--> 
                            <i *ngIf="isLoading$ | async" class="fas fa-spinner fa-spin"></i>
                            <mat-progress-bar *ngIf="isLoading$ | async" mode="query"></mat-progress-bar>
                            <!--===========================-->
                        </mat-card-footer>
                    
                    </mat-card>
                </div>
                <!--========================================-->
            </div>
        <!-------------------------------------------------------->
    </mat-card-content>
</mat-card>


<div *ngIf="affichage"  class="row">
    <div class="col-lg-12 col-md-12">
        <mat-card class="mb-25 tagus-card">
            <mat-card-header class="border-bottom">
                <!-- <h6 class="mb-0">Affichage des données</h6> -->
            </mat-card-header>
            <mat-card-content>
                   <!--------------------Affichage des données------------------------------------>
                    <div   class="row table-container  tableFixHead table-striped">                
                        <table id="export" mat-table [dataSource]="dataSourcePays" sortPays>
        
                            <ng-container matColumnDef="id">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
                                <td mat-cell *matCellDef="let row"> {{row.id}} </td>
                            </ng-container>

                            <ng-container matColumnDef="division">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Div. admin</th>
                                <td mat-cell *matCellDef="let row">
                                    <img src="http://154.127.90.218:8000/{{row.divisionadministrative.image}}" width="30px" height="15px">&nbsp;
                                    {{row.divisionadministrative.nomDivision}}</td>
                            </ng-container>

                            <ng-container matColumnDef="indicateur">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Indicateur</th>
                                <td mat-cell *matCellDef="let row"> {{row.indicateur.libelle}}</td>
                            </ng-container>

                            <ng-container matColumnDef="valeur">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Valeur</th>
                                <td mat-cell *matCellDef="let row">
                                <!-- {{row.quantite | number:'1.0-2' }} -->
                                @if (row.valeur_gen == 0) {
                                    N/A
                                } @else {
                                    <!-- {{row.valeur_gen | currency : 'XOF' : 'symbol' : '1.0' : 'fr' }} -->
                                    {{row.valeur_gen }}
                                } 
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="unite">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Unité</th>
                                <td mat-cell *matCellDef="let row"> {{row.unite_devise}}</td>
                            </ng-container>
                
                            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;  let i = index" class="mat-row" 
                            [@listItem]="animationStates[i]"
                            (mouseenter)="onListItemMouseEnter(i)"
                            (mouseleave)="onListItemMouseLeave(i)"></tr>
                
                            <!-- Row shown when there is no matching data. -->
                            <tr class="mat-row" *matNoDataRow>
                              <!-- <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td> -->
                            </tr>
                        </table>
                        <mat-paginator #paginatorPays="matPaginator"
                          [length]="dataSourcePays?.filteredData?.length" 
                          [pageSize]="5"
                          [pageSizeOptions]="[5, 10, 25, 50, 100]" aria-label="Select page"
                          showFirstLastButtons>
                        </mat-paginator>
                    </div>
                    <!-------------------------------------------------------->
            </mat-card-content>
        </mat-card>
    </div>
</div>


